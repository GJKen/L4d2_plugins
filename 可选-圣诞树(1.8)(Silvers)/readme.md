# 📌圣诞树

原作 [alliedmods](https://forums.alliedmods.net/showthread.php?p=2672241)

生成圣诞树或礼物盒子, 可临时生成或保存到地图上

> 感谢 "apples1949" 汉化插件

> 自用配置> data/l4d_christmas_tree.cfg 文件

<details><summary>❗注意项</summary>

- 礼物可以破坏并生成物品或武器.

- L4D 缺少 L4D2 礼物模型并使用板条箱.

- 瞄准侏儒进行删除, 编辑位置和角度.这棵树是非实心的.

- 每张地图最多 2 棵树.礼物仅限 32 个.重新编译以更改限制.

- 树(默认设置)使用大约 45 个实体(2 个模型 + 6 个礼物 + 1 个火花 + 4 个灯光 + 32 个精灵)爆炸时大约有 8 个临时实体.

- 它不是服务器的 CPU 密集型插件. Rainbow 选项会稍微增加带宽.

- 当检测到 l4d_dissolve_infected.txt 游戏数据时, 可以选择向礼物添加溶解效果.可以使用 l4d_tree_effects cvar 禁用.

- 这个插件很大, 因为它具有库存效果, 生成能力以及所有相关选项.

- 完全处理后期加载, 卸载, 打开/关闭和删除未使用的项目.

- 推荐的附加插件: 用于装饰的霓虹灯光束.天气控制或圣诞节下雪.

- 可选的数据配置提供了保存到每个 Valve 地图的树.感谢 "Dragokas" 提供的L4D1数据.
</details>

---
<details><summary>Command | 指令</summary>

|指令|用法|权限|
|-|-|-|
|`!tree_spawn`|在你的十字准线处生成一棵临时的礼物/树, 用法:sm_tree_spawn [0=礼物, 1=树]|Admin|
|`!tree_save`|在你的十字准线处生成一棵礼物/树并保存到配置中, 用法:sm_tree_save[0=礼物, 1=树]|Admin|
|`!tree_del`|删除您指向的礼物/树, 并从配置中删除(如果已保存)|Admin|
|`!tree_clear`|从当前地图中删除此插件生成的所有礼物/树木|Admin|
|`!tree_wipe`|从当前地图中删除所有礼物/树木并从配置中删除它们|Admin|
|`!tree_reload`|重置插件并重新加载数据配置和保存的数据|Admin|
|`!tree_glow`|切换以启用所有礼物/树木的发光, 以查看它们的放置位置|Admin|
|`!tree_list`|显示礼物/树位置列表和总数|Admin|
|`!tree_tele`|传送到礼物/树(用法:sm_tree_tele <索引:1 到 MAX_SPAWNS (32)>)|Admin|
|`!tree_ang`|显示一个菜单来调整十字准线上方的礼物/树角度|Admin|
|`!tree_pos`|显示一个菜单来调整十字准线结束时的礼物/树原点|Admin|
</details>

Video | 影片展示
<br>None

<details><summary>Image | 图示</summary>

![l4d_christmas_tree.smx](https://forums.alliedmods.net/image-proxy/46b4172823e0f72231b3a74d521c3741e752d59d/68747470733a2f2f692e696d6775722e636f6d2f615747435534672e6a7067)

![l4d_christmas_tree.smx](https://forums.alliedmods.net/image-proxy/0c84013581c4e8fba792935bf1c09f1e8ae6bd9c/68747470733a2f2f692e696d6775722e636f6d2f616a4c497254352e6a7067)

![l4d_christmas_tree.smx](https://forums.alliedmods.net/image-proxy/6ec3c132b292d75c8dbef415d8283a7015b653a7/68747470733a2f2f692e696d6775722e636f6d2f5052374f656b552e6a7067)
</details>

<details><summary>ConVar | 控制台变量</summary>

cfg/sourcemod/l4d_mutants.cfg
```sourcepawn
// This file was auto-generated by SourceMod (v1.11.0.6936)
// ConVars for plugin "l4d_christmas_tree.smx"

// 0=插件禁用, 1=插件启用.
// Default: "1"
l4d_tree_allow "1"

// 要显示多少列球
// Default: "4"
l4d_tree_ball_columns "4"

// 每一列要显示多少个球
// Default: "8"
l4d_tree_ball_count "8"

// 从树底开始显示球的距离
// Default: "45.0"
l4d_tree_ball_radius "45.0"

// 礼物颜色, 0=关闭(默认的礼物颜色)三个数值在0-255之间,用空格分隔, RGB:红绿蓝
// Default: "255 0 0"
l4d_tree_col_gift "255 0 0"

// 树的颜色, 0=关闭(默认的礼物颜色)三个数值在0-255之间,用空格分隔, RGB:红绿蓝
// Default: "0 255 0"
l4d_tree_col_tree "0 255 0"

// 0=关闭, 1=灯光,2=球,4=火花,8=溶解(礼物),16=烟雾(礼物-可能导致服务器罕见的崩溃),31=全部, 数字相加
// Default: "23"
l4d_tree_effects "23"

// 在树下产生多少个礼物
// Default: "0"
l4d_tree_gifts "0"

// 礼物发光轮廓颜色, 0=关闭(默认的礼物颜色)三个数值在0-255之间,用空格分隔, RGB:红绿蓝
// Default: "255 0 0"
l4d_tree_glow "255 0 0"

// 0:不破坏或掉落物品 >0:礼物在破裂和掉落物品之前的健康状况
// Default: "1"
l4d_tree_health "1"

// 以下物品武器生成百分比几率 数值必须用逗号分隔 肾上腺素, 药丸, 燃烧瓶, 自制手雷, 胆汁, 医疗包, 电击器, 高爆弹药包, 燃烧弹药包, M4步枪, 1代连喷, 木狙, mac冲锋枪, 木喷, 小手枪, 铁喷, 三芯
// Default: "80,100,25,25,25,25,15,15,15,2,2,2,5,5,5,2,0,0,0,2,0,2,5,0,0,2,0,5,0,5"
l4d_tree_items "80,100,25,25,25,25,15,15,15,2,2,2,5,5,5,2,0,0,0,2,0,2,5,0,0,2,0,5,0,5"

// 以下近战武器生成几率 数值必须用逗号分隔:消防斧, 棒球棍, 板球棍, 撬棍, 平底锅, 高尔夫球棍, 吉他, 武士刀, 看到, 警棍, 小刀, 草叉, 铲子
// Default: "0,0,0,10,0,0,0,50,50,0,50,10,10"
l4d_tree_melee "0,0,0,10,0,0,0,50,50,0,50,10,10"

// 在这些游戏模式中启用插件, 用英文逗号隔开(无空格). (无内容=全部游戏模式)
// Default: ""
l4d_tree_modes ""

// 在这些游戏模式中关闭插件, 用英文逗号隔开(无空格). (无内容=无)
// Default: ""
l4d_tree_modes_off ""

// 在这些游戏模式中启用插件. 0=全部游戏模式, 1=战役, 2=生还者, 4=对抗, 8=清道夫. 将这些数字叠加在一起
// Default: "0"
l4d_tree_modes_tog "0"

// 0=关闭 1=礼物随时间变化颜色 2=树木随着时间的推移而改变颜色, 3=两个都有
// Default: "2"
l4d_tree_rainbow "2"

// 使用彩虹选项时颜色变化的速度
// Default: "10"
// Minimum: "1.000000"
// Maximum: "255.000000"
l4d_tree_rate "10"

// 每秒更新颜色的频率(秒)
// Default: "0.2"
// Minimum: "0.100000"
l4d_tree_speed "0.2"
```
</details>

<details><summary>Config | 配置</summary>

自用生成的圣诞树配置文件

data/l4d_christmas_tree.cfg
```sourcepawn
"spawns"
{
	"c1m1_hotel"
	{
		"num"		"1"
		"1"
		{
			"ang"		"0.000000 -129.773453 0.000000"
			"pos"		"566.881714 5305.926758 2881.000000"
			"type"		"1"
		}
	}
	"c1m2_streets"
	{
		"num"		"1"
		"1"
		{
			"ang"		"0.000000 -122.298248 0.000000"
			"pos"		"-3220.839600 1696.282837 85.209900"
			"type"		"1"
		}
	}
	"c1m3_mall"
	{
		"num"		"3"
		"1"
		{
			"ang"		"0.000000 -113.159470 0.000000"
			"pos"		"957.411438 -4025.054688 0.031250"
			"type"		"1"
		}
		"3"
		{
			"ang"		"0.000000 -4.415573 0.000000"
			"pos"		"-544.338501 -4205.104004 536.031250"
			"type"		"1"
		}
	}
	"c1m4_atrium"
	{
		"num"		"2"
		"2"
		{
			"ang"		"0.000000 2.893325 0.000000"
			"pos"		"-4058.907715 -3409.848877 0.031265"
			"type"		"1"
		}
	}
	"c2m1_highway"
	{
		"num"		"2"
		"1"
		{
			"ang"		"0.000000 -13.056152 0.000000"
			"pos"		"11266.948242 7873.917480 -576.184204"
			"type"		"1"
		}
		"2"
		{
			"ang"		"0.000000 268.213654 0.000000"
			"pos"		"2500.567383 2542.663330 -960.828796"
			"type"		"1"
		}
	}
	"c2m2_fairgrounds"
	{
		"num"		"4"
		"1"
		{
			"ang"		"0.000000 -12.997864 0.000000"
			"pos"		"2387.690186 2139.404297 4.703461"
			"type"		"1"
		}
		"2"
		{
			"ang"		"0.000000 163.551605 0.000000"
			"pos"		"2377.336182 -226.286575 0.472305"
			"type"		"1"
		}
		"3"
		{
			"ang"		"0.000000 80.647972 0.000000"
			"pos"		"-3341.749023 -5078.636230 -125.060265"
			"type"		"1"
		}
	}
	"c2m3_coaster"
	{
		"num"		"2"
		"1"
		{
			"ang"		"0.000000 18.954830 0.000000"
			"pos"		"2810.426758 2192.626709 -7.968735"
			"type"		"1"
		}
		"2"
		{
			"ang"		"0.000000 185.130630 0.000000"
			"pos"		"-4784.146973 1515.734863 24.592789"
			"type"		"1"
		}
	}
	"c2m4_barns"
	{
		"num"		"2"
		"1"
		{
			"ang"		"0.000000 -35.436077 0.000000"
			"pos"		"178.024368 1603.633301 -256.000000"
			"type"		"1"
		}
		"2"
		{
			"ang"		"0.000000 -39.899696 0.000000"
			"pos"		"-2232.236572 1187.397583 -185.729858"
			"type"		"1"
		}
	}
	"c2m5_concert"
	{
		"num"		"2"
		"2"
		{
			"ang"		"0.000000 -135.182907 0.000000"
			"pos"		"-2296.452881 2559.839600 -256.000000"
			"type"		"1"
		}
	}
	"nanningcity_workzone_m5"
	{
		"num"		"2"
		"1"
		{
			"ang"		"0.000000 58.039566 0.000000"
			"pos"		"9191.968750 -7145.865723 123.722916"
			"type"		"0"
		}
		"2"
		{
			"ang"		"0.000000 -34.575386 0.000000"
			"pos"		"12670.427734 -10317.600586 -0.000015"
			"type"		"1"
		}
	}
	"c4m4_milltown_b"
	{
		"num"		"1"
		"1"
		{
			"ang"		"0.000000 19.805054 0.000000"
			"pos"		"1672.923584 3297.357910 96.015442"
			"type"		"1"
		}
	}
	"c4m5_milltown_escape"
	{
		"num"		"2"
		"1"
		{
			"ang"		"0.000000 -67.406433 0.000000"
			"pos"		"-5829.618652 7643.689453 253.959641"
			"type"		"1"
		}
		"2"
		{
			"ang"		"0.000000 -2.894897 0.000000"
			"pos"		"-6011.371582 6868.131348 96.000000"
			"type"		"1"
		}
	}
	"c13m1_alpinecreek"
	{
		"num"		"3"
		"1"
		{
			"ang"		"0.000000 241.812561 0.000000"
			"pos"		"905.865295 1378.604980 355.252625"
			"type"		"1"
		}
		"2"
		{
			"ang"		"0.000000 -76.301025 0.000000"
			"pos"		"1091.010132 -1155.959839 352.031250"
			"type"		"0"
		}
		"3"
		{
			"ang"		"0.000000 -41.683838 0.000000"
			"pos"		"1088.782227 -1146.820068 357.589905"
			"type"		"1"
		}
	}
	"c13m2_southpinestream"
	{
		"num"		"2"
		"1"
		{
			"ang"		"0.000000 224.062622 0.000000"
			"pos"		"8381.537109 4955.455566 466.294922"
			"type"		"1"
		}
		"2"
		{
			"ang"		"0.000000 37.245174 0.000000"
			"pos"		"-327.231598 8766.519531 46.511978"
			"type"		"1"
		}
	}
}
```
</details>

<details><summary>Translation Support | 支持语言</summary>

```
English
繁體中文
简体中文
```
</details>

Require | 需求
<br>None

<details><summary>Related Plugin | 相关插件</summary>

1. [[L4D2] Gift Rewards](https://forums.alliedmods.net/showthread.php?t=320067)
</details>

<details><summary>Changelog | 版本日志</summary>

- 1.8 (30-Jul-2022)
    - Changed cvar "l4d_tree_effects" to turn gifts smoke on or off. This may fix a random rare server crash. Thanks to "Hawkins" for reporting.

- 1.7 (06-Dec-2021)
    - L4D2: Added cvar "l4d_tree_melee" to control melee type spawn chance. Requested by "CaRmilla".
    - L4D2: Modified cvar "l4d_tree_items" adding an entry to the end for melee chance spawn.
    - Changes to fix warnings when compiling on SourceMod 1.11.

- 1.6 (30-Sep-2020)
    - Fixed compile errors on SM 1.11.

- 1.5 (10-May-2020)
    - Blocked glow command from L4D1 which does not support glows.
    - Extra checks to prevent "IsAllowedGameMode" throwing errors.
    - Various changes to tidy up code.

- 1.4 (01-Apr-2020)
    - Fixed "IsAllowedGameMode" from throwing errors when the "_tog" cvar was changed before MapStart.

- 1.3 (19-Dec-2019)
    - Versus gamemodes now spawn the same items for both teams.

- 1.2 (07-Nov-2019)
    - Fixed incorrect gamedata path not loading dissolve if available.

- 1.1 (07-Nov-2019)
    - Fixed gamedata missing error.
    - Fixed gifts spawning in the ground in L4D1.

- 1.0 (07-Nov-2019)
    - Initial release.
</details>